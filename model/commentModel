const db=require("../db/connection")




function fetchCommentsByID(article_id){
            
    const bodyArtic = db.query(`SELECT article_id FROM articles WHERE article_id = $1;`, [article_id])
        

    const bodyComm = db.query(`SELECT * FROM comments WHERE article_id = $1`, [article_id])
   
        
    return Promise.all([bodyArtic, bodyComm])
            .then(([bodyArtic, bodyComm]) => {
                if(!bodyArtic.rows.length) {
                return Promise.reject
                ({ status: 404, msg: `No review found for review_id: ${review_id}`});
                } 
                return bodyComm.rows;
            });
};

function addComment(articleId, comment){
  const { body, author } = comment;
  return db.query(`INSERT INTO comments (body, author, article_id)
    VALUES ($1, $2, $3) 
    RETURNING *;`,[body, author, articleId])
    .then((response) => {
      return response.rows[0];
    });
};


module.exports= {fetchCommentsByID, addComment}